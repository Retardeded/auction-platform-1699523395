<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>User Profile</title>
  <meta name="_csrf" th:content="${_csrf.token}"/>
  <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
  <link th:href="@{/css/search-bar.css}" rel="stylesheet" />
  <link th:href="@{/css/sidebar.css}" rel="stylesheet" />
  <link th:href="@{/css/profile.css}" rel="stylesheet" />
  <script th:src="@{/js/dropdown.js}"></script>
  <script th:src="@{/js/auction-search.js}"></script>
  <script th:src="@{/js/profile.js}"></script>
</head>
<body>
<nav class="navbar">
  <div class="search-container">
    <form action="/search" method="get" class="search-form">
      <input type="text" placeholder="What you search for..." name="search" th:value="${param.search}" class="search-input" />
      <input type="text" placeholder="Location..." name="location" th:value="${param.location}" class="location-input" />
      <input type="hidden" name="category" th:value="${param.category}" class="category-input" />
      <button type="submit" class="search-button">Search</button>
    </form>
  </div>
  <div class="navbar-right">
    <button onclick="window.location.href='/auctions/create';" class="create-auction-button">Create Auction</button>
    <div class="profile-container">
      <button class="profile-button" onclick="toggleDropdown()" th:text="${currentUser.email}">User Email</button>
      <div id="myDropdown" class="dropdown-content">
        <div class="dropdown-button" onclick="window.location.href='/profile';">
          My Profile
        </div>
        <div class="dropdown-button" onclick="document.getElementById('logout-form').submit();">
          Logout
        </div>
        <form id="logout-form" action="/logout" method="post" style="display: none;">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
          <input type="submit" value="Logout" />
        </form>
      </div>
    </div>
    <div class="notification-container">
      <span class="notification-bell" onclick="toggleNotificationsDropdown()">ðŸ””</span>
      <span class="notification-count">0</span>
      <div id="notificationDropdown" class="notification-dropdown-content" style="display: none;">
      </div>
    </div>
  </div>
</nav>

<div class="layout-container">
  <div class="sidebar-container">
    <div class="sidebar">
      <h2>Auction Sections</h2>
      <a href="/profile/user-auctions" class="sidebar-link">View My Listings</a>
      <a href="/profile/purchase-auctions" class="sidebar-link">View My Purchases</a>
      <a href="/profile/my-bids-and-watches" class="sidebar-link">View My Active Bids and Watches</a>
    </div>
    <div class="sidebar">
      <h2>Account Sections</h2>
      <a href="/profile/edit" class="sidebar-link">Edit Profile</a>
      <a href="/profile/change-password" class="sidebar-link">Change Password</a>
    </div>
    <div class="sidebar">
      <h2>Back Section</h2>
      <a href="/home" class="sidebar-link">Go Back Home</a>
    </div>
  </div>
  <div class="main-content">
    <div class="profile-details">
      <p><strong>Email:</strong> <span th:text="${currentUser.email}"></span></p>
      <p><strong>Username:</strong> <span th:text="${currentUser.username}"></span></p>
      <p><strong>First Name:</strong> <span th:text="${currentUser.firstName}"></span></p>
      <p><strong>Last Name:</strong> <span th:text="${currentUser.lastName}"></span></p>
      <p><strong>Location:</strong> <span th:text="${currentUser.location}"></span></p>
      <p><strong>Phone Number:</strong> <span th:text="${currentUser.phoneNumber}"></span></p>
    </div>
  </div>
</div>

<div th:if="${message}" class="success-message">
  <p th:text="${message}"></p>
</div>

</body>
</html>